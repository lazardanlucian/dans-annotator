/* Polished styles for Dan's Annotator plugin UI/UX */
.annotate-highlight,
.annotate-focus {
    position:relative !important;
    outline:none !important;
    border-radius:12px !important;
    transition:box-shadow 160ms ease, background 160ms ease;
}

.annotate-relative-target {
    position:relative !important;
}

.annotate-highlight::after,
.annotate-focus::after {
    content:'';
    position:absolute;
    inset:-6px;
    border-radius:16px;
    box-shadow:0 0 0 2px rgba(255,170,0,0.35);
    background:rgba(255,196,120,0.18);
    pointer-events:none;
}

.annotate-focus::after {
    box-shadow:0 0 0 3px rgba(255,128,0,0.55);
    background:rgba(255,188,66,0.25);
}

body.annotate-creating {
    cursor:pointer;
}

body.annotate-selecting-existing-disabled .annotate-badge {
    opacity:0.65;
    transition:opacity 120ms ease;
}

body.annotate-selecting-existing-disabled .annotate-badge:hover {
    opacity:0.4;
    transform:translate(-50%, -50%);
}

body.annotate-selecting-existing-disabled.annotate-selecting-child-mode .annotate-has-annotation {
    position:relative !important;
    transition:filter 140ms ease, opacity 140ms ease;
}

body.annotate-selecting-existing-disabled.annotate-selecting-child-mode .annotate-has-annotation:hover {
    filter:grayscale(0.6);
    opacity:0.75;
}

body.annotate-selecting-existing-disabled.annotate-selecting-child-mode .annotate-has-annotation:hover::after {
    content:'';
    position:absolute;
    inset:0;
    background:rgba(255,255,255,0.3);
    pointer-events:none;
    border-radius:inherit;
}

body:not(.annotate-enabled) .annotate-badge,
body:not(.annotate-enabled) .annotate-floating-controls,
body:not(.annotate-enabled) #annotate-panel {
    display:none !important;
}

.annotate-btn-icon-hidden {
    opacity:0;
    pointer-events:none;
    visibility:hidden;
}

.annotate-btn-icon {
    transition:color 120ms ease, opacity 180ms ease;
}

.annotate-btn-icon.annotate-copy-success {
    color:#22c55e;
    opacity:0.3;
}


/* Badge: absolutely positioned centered on the target element */
.annotate-badge {
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%, -50%);
    display:inline-block;
    background:#ff5a00;
    color:#fff;
    padding:4px 8px;
    border-radius:14px;
    font-size:12px;
    line-height:1;
    box-shadow:0 2px 6px rgba(0,0,0,0.12);
    cursor:pointer;
    font-weight:600;
    transition:transform 120ms ease;
    white-space:nowrap;
    letter-spacing:0.5px;
    text-transform:uppercase;
}

.annotate-badge:hover {
    transform:translate(-50%, -50%) scale(1.1);
}


.annotate-floating-controls {
    position:fixed;
    bottom:24px;
    right:24px;
    display:none;
    flex-direction:column;
    gap:10px;
    z-index:999998;
}

.annotate-floating-controls.annotate-floating-visible {
    display:flex;
}

.annotate-floating-btn {
    border:0;
    border-radius:999px;
    padding:10px 18px;
    font-size:13px;
    font-weight:600;
    cursor:pointer;
    box-shadow:0 10px 25px rgba(0,0,0,0.15);
    transition:transform 120ms ease, box-shadow 120ms ease, background 120ms ease;
}

.annotate-floating-btn:active {
    transform:scale(0.98);
}

.annotate-floating-view {
    background:#ffffff;
    color:#0073aa;
    border:1px solid #d8e2ee;
}

.annotate-floating-create {
    background:#0073aa;
    color:#fff;
}

.annotate-floating-donate {
    background:#ecfeff;
    color:#0ea5e9;
    border:1px solid #bae6fd;
}

.annotate-floating-donate:hover {
    box-shadow:0 0 0 2px rgba(14,165,233,0.15), 0 12px 30px rgba(14,165,233,0.25);
}

.annotate-floating-btn.active {
    box-shadow:0 0 0 2px rgba(0,115,170,0.25), 0 12px 30px rgba(0,0,0,0.18);
}


.annotate-panel {
    position:fixed;
    right:18px;
    top:72px;
    width:400px;
    max-width:calc(100% - 36px);
    max-height:82vh;
    background:#fdfdfd;
    border-radius:16px;
    border:1px solid rgba(8,24,47,0.08);
    box-shadow:0 18px 45px rgba(15,23,42,0.25);
    z-index:999999;
    overflow:hidden;
    padding:0;
    transform:translateY(6px) scale(0.98);
    opacity:0;
    transition:all 180ms ease-out;
    backdrop-filter:blur(12px);
    display:none;
    flex-direction:column;
}

.annotate-panel-visible {
    display:flex;
    flex-direction:column;
}

.annotate-panel-reserve-confirm {
    margin-bottom:0;
    padding-bottom:0;
}

.annotate-panel.open {
    transform:translateY(0) scale(1);
    opacity:1;
}

.annotate-donate-modal {
    position:fixed;
    inset:0;
    z-index:999999;
    display:flex;
    align-items:center;
    justify-content:center;
}

.annotate-donate-modal[hidden] {
    display:none;
}

.annotate-donate-backdrop {
    position:absolute;
    inset:0;
    background:rgba(15,23,42,0.55);
    backdrop-filter:blur(3px);
}

.annotate-donate-card {
    position:relative;
    background:#f8fafc;
    border-radius:18px;
    padding:0;
    max-width:850px;
    width:min(850px, calc(100% - 40px));
    box-shadow:0 18px 45px rgba(15,23,42,0.35);
    border:1px solid rgba(148,163,184,0.35);
    z-index:1;
    color:#0f172a;
    transition:transform 0.2s ease,opacity 0.2s ease;
}

.annotate-donate-modal.is-leaving .annotate-donate-card {
    transform:scale(0.95);
    opacity:0;
}

.annotate-donate-close {
    position:absolute;
    top:12px;
    right:12px;
    background:rgba(15,23,42,0.08);
    border:1px solid rgba(148,163,184,0.35);
    border-radius:50%;
    width:30px;
    height:30px;
    cursor:pointer;
    font-weight:700;
    color:#0f172a;
    z-index:2;
}

.annotate-donate-iframe {
    width:100%;
    border:0;
    border-radius:16px;
    min-height:300px;
    background:transparent;
    box-shadow:inset 0 0 0 1px rgba(148,163,184,0.35);
}



.annotate-header {
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:14px 18px;
    min-height:56px;
    border-bottom:1px solid rgba(15,23,42,0.07);
    background:linear-gradient(135deg,#101828,#1d2c4e);
    color:#fff;
}

.annotate-header strong {
    font-size:15px;
    font-weight:600;
    color:#fff;
}

.annotate-header-info {
    display:flex;
    flex-direction:column;
    gap:4px;
    color:#fff;
}

.annotate-header-info-thread .annotate-subtitle {
    color:rgba(255,255,255,0.75);
}

.annotate-subtitle {
    font-size:12px;
    color:rgba(15,23,42,0.7);
}

.annotate-missing-pill {
    display:inline-flex;
    align-items:center;
    padding:3px 10px;
    border-radius:999px;
    font-size:11px;
    font-weight:600;
    background:rgba(224,86,79,0.15);
    color:#9b1c1c;
}

.annotate-controls {
    display:flex;
    gap:6px;
    align-items:center;
}

.annotate-btn-icon {
    background:transparent;
    border:0;
    padding:4px 6px;
    border-radius:4px;
    cursor:pointer;
    font-size:16px;
    line-height:1;
    transition:background 100ms;
}

.annotate-btn-icon:hover {
    background:rgba(0,0,0,0.05);
}


.annotate-selector {
    font-size:12px;
    color:#1f2937;
    padding:12px 18px;
    border-bottom:1px solid #eff2f5;
    background:#fdfefe;
}

.annotate-selector code {
    display:block;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
    max-width:100%;
    background:#eef4ff;
    padding:6px 8px;
    border-radius:6px;
    margin-top:6px;
    font-size:11px;
    color:#1b2a3b;
    letter-spacing:0.2px;
}


.annotate-comments {
    flex:1 1 auto;
    overflow:auto;
    padding:14px 18px;
    background:#fefefe;
    min-height:0;
}

.annotate-comment {
    border:1px solid #edf1f5;
    border-radius:10px;
    padding:10px 12px;
    margin-bottom:10px;
    background:#fff;
    box-shadow:0 4px 14px rgba(15,23,42,0.04);
}

.annotate-comment .annotate-comment-meta {
    color:#4b5563;
    font-size:12px;
    margin-bottom:6px;
    display:flex;
    justify-content:space-between;
}

.annotate-comment .annotate-comment-body {
    font-size:14px;
    color:#0f172a;
}

.annotate-comment .annotate-comment-body a {
    color:#0067cc;
    text-decoration:underline;
}

.annotate-comment .annotate-comment-body .annotate-mention {
    font-weight:600;
    color:#0073aa;
}


.annotate-form {
    padding:14px 18px;
    border-top:1px solid #eef0f3;
    background:linear-gradient(180deg,#fff,#f7f9fc);
    flex-shrink:0;
}

.annotate-form textarea {
    width:100%;
    box-sizing:border-box;
    padding:10px 12px;
    border:1px solid #dae3f0;
    border-radius:10px;
    font-size:14px;
    resize:vertical;
    min-height:56px;
    font-family:inherit;
    box-shadow:0 3px 10px rgba(15,23,42,0.06) inset;
}

.annotate-actions {
    margin-top:8px;
}

.annotate-actions-split {
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    flex-wrap:wrap;
}

.annotate-actions-left, .annotate-actions-right {
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    align-items:center;
}

.annotate-actions-left {
    flex:1;
}

.annotate-btn {
    border:1px solid transparent;
    border-radius:8px;
    padding:7px 14px;
    font-size:12px;
    font-weight:600;
    cursor:pointer;
    transition:background 120ms, border-color 120ms, color 120ms, box-shadow 120ms;
}

.annotate-btn-primary {
    background:#0073aa;
    color:#fff;
    border-color:#0073aa;
    box-shadow:0 8px 20px rgba(15,98,254,0.25);
}

.annotate-btn-primary:hover {
    background:#0b4ec7;
    border-color:#0b4ec7;
}

.annotate-btn-secondary {
    background:#f1f5f9;
    color:#0f172a;
    border-color:#d5dae1;
}

.annotate-btn-secondary:hover {
    background:#e2e8f0;
}

.annotate-btn-danger {
    background:#fee2e2;
    color:#991b1b;
    border-color:#fecaca;
}

.annotate-btn-danger:hover {
    background:#fecaca;
}

.annotate-confirm-panel {
    padding:12px 18px;
    border-top:1px solid #eceff3;
    background:#fff7f7;
    margin:16px 18px 0;
    box-shadow:0 12px 24px rgba(15,23,42,0.08);
    border-radius:10px;
    position:relative;
    flex-shrink:0;
}

.annotate-confirm-hidden {
    display:none;
}

.annotate-confirm-panel p {
    margin:0 0 8px 0;
    font-size:13px;
    color:#7f1d1d;
}

.annotate-confirm-actions {
    display:flex;
    gap:10px;
    flex-wrap:wrap;
}


/* Autocomplete dropdown positioned near the textarea */
.annotate-autocomplete {
    position:absolute;
    background:#fff;
    border:1px solid #e1e4e8;
    z-index:1000000;
    border-radius:6px;
    box-shadow:0 6px 18px rgba(7,14,30,0.12);
    overflow:hidden;
    display:none;
    max-width:320px;
    min-width:200px;
}

.annotate-autocomplete.annotate-autocomplete-visible {
    display:block;
}

.annotate-ac-item {
    padding:8px 10px;
    cursor:pointer;
    font-size:13px;
    color:#111;
}

.annotate-ac-item:hover, .annotate-ac-item.active {
    background:#f6f8fb;
}


/* View All list */
.annotate-all-list {
    padding:12px 14px;
}

.annotate-empty-state {
    text-align:center;
    padding:40px 14px;
    color:#666;
}

.annotate-empty-state p {
    margin:8px 0;
}

.annotate-empty-hint {
    font-size:12px;
    color:#999;
}


/* Thread sections */
.annotate-section {
    margin-bottom:16px;
}

.annotate-section-title {
    font-size:13px;
    font-weight:600;
    color:#333;
    margin:0 0 10px 0;
    display:flex;
    align-items:center;
    gap:6px;
}

.annotate-section-dot {
    font-size:14px;
    line-height:1;
}

.annotate-section-dot-missing {
    color:#c33;
}

.annotate-section-dot-open {
    color:green;
}

.annotate-section-dot-closed {
    color:#999;
}


/* Thread card */
.annotate-thread-card {
    background:#fff;
    border:1px solid #e0e8f2;
    border-radius:12px;
    padding:12px;
    margin-bottom:10px;
    box-shadow:0 12px 30px rgba(15,23,42,0.08);
    transition:transform 140ms ease, box-shadow 140ms ease;
}

.annotate-thread-card.annotate-thread-missing {
    border-left:4px solid #e0564f;
}

.annotate-thread-card {
    cursor:pointer;
}

.annotate-thread-card:hover {
    transform:translateY(-2px);
    box-shadow:0 16px 32px rgba(15,23,42,0.12);
}

.annotate-thread-header {
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
    gap:12px;
    margin-bottom:8px;
}

.annotate-thread-selector {
    background:#f4f7fb;
    padding:6px 8px;
    border-radius:6px;
    font-size:11px;
    color:#374151;
    max-width:240px;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
    flex:1;
}

.annotate-thread-time {
    font-size:11px;
    color:#94a3b8;
    white-space:nowrap;
}

.annotate-thread-snippet {
    font-size:12px;
    color:#4b5563;
    margin-top:4px;
    line-height:1.4;
    max-height:3.2em;
    overflow:hidden;
}

.annotate-thread-author {
    font-weight:600;
    color:#0f172a;
    margin-right:0px;
}


#annotate-panel[data-panel-mode="view-all"] .annotate-header {
    background:linear-gradient(135deg,#101828,#1d2c4e);
    color:#fff;
}

#annotate-panel[data-panel-mode="view-all"] .annotate-header strong {
    color:#fff;
}

#annotate-panel[data-panel-mode="view-all"] .annotate-subtitle {
    color:rgba(255,255,255,0.7);
}

#annotate-panel[data-panel-mode="view-all"] .annotate-missing-pill {
    background:rgba(255,255,255,0.2);
    color:#fff;
}

#annotate-panel[data-panel-mode="view-all"] .annotate-controls .annotate-btn-icon {
    color:#fff;
}

#annotate-panel[data-panel-mode="view-all"] {
    display:flex;
    flex-direction:column;
}

#annotate-panel[data-panel-mode="view-all"] .annotate-all-list {
    background:#f6f9ff;
    border-top:1px solid rgba(255,255,255,0.08);
    padding:20px;
    flex:1 1 auto;
    overflow:auto;
    min-height:0;
}

#annotate-panel[data-panel-mode="view-all"] .annotate-section-title {
    text-transform:uppercase;
    font-size:11px;
    letter-spacing:1px;
    color:#475569;
}

#annotate-panel[data-panel-mode="thread"] .annotate-header {
    background:linear-gradient(135deg,#101828,#1d2c4e);
    color:#fff;
}

#annotate-panel[data-panel-mode="thread"] .annotate-header strong {
    color:#fff;
}

#annotate-panel[data-panel-mode="thread"] .annotate-subtitle {
    color:rgba(255,255,255,0.75);
}

#annotate-panel[data-panel-mode="thread"] .annotate-controls .annotate-btn-icon {
    color:#fff;
}


@media (max-width: 560px) {
.annotate-panel {
    right:12px;
    left:12px;
    top:60px;
    width:auto;
}

}
#annotate-thread-view {
    display:flex;
    flex-direction:column;
    flex:1 1 auto;
    min-height:0;
}

#annotate-viewall-view {
    display:flex;
    flex-direction:column;
    flex:1 1 auto;
    height:100%;
    min-height:0;
}

#annotate-panel[data-panel-mode="view-all"] #annotate-thread-view {
    display:none !important;
}

#annotate-panel[data-panel-mode="thread"] #annotate-viewall-view {
    display:none !important;
}
